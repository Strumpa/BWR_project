MODULE GEO: ;
*----
*  Input geometry data
*----
PARAMETER GEON2 ::
::: LINKED_LIST GEON2 ; ;

*
GEON2 := GEO: :: CAR2D 5 5 
  EDIT 10
  X- DIAG X+ REFL
  Y- REFL Y+ DIAG
    WBC1 WB1 WB2 WB3 WBC2
          C01 C02 C03 WR1
             CHNL C04 WR2
                  C05 WR3
                      WTC
  MESHX 0.0 1.0 2.0 3.0 4.0 5.0
  MESHY 0.0 1.0 2.0 3.0 4.0 5.0
    ::: WBC1 := GEO: CAR2D 3 3 
        MESHX 0.0 0.3333 0.6666 1.0
        MESHY 0.0 0.3333 0.6666 1.0
        MIX 70 70 70 70 60 60 70 60 7 ;
    ::: WTC := GEO: CAR2D 3 3 
        MESHX 0.0 0.3333 0.6666 1.0
        MESHY 0.0 0.3333 0.6666 1.0
        MIX 7 60 70 60 60 70 70 70 70 ;
    ::: WB1 := GEO: CAR2D 1 3
        MESHX 0.0 1.0
        MESHY 0.0 0.3333 0.6666 1.0
        MIX 70 60 7
      ;
    ::: WB2 := GEO: CAR2D 1 3
        MESHX 0.0 1.0
        MESHY 0.0 0.3333 0.6666 1.0
        MIX 70 60 7
      ;
    ::: WB3 := GEO: CAR2D 1 3
        MESHX 0.0 1.0
        MESHY 0.0 0.3333 0.6666 1.0
        MIX 70 60 7
      ;
    ::: WBC2 := GEO: CAR2D 3 3 
        MESHX 0.0 0.3333 0.6666 1.0
        MESHY 0.0 0.3333 0.6666 1.0
        MIX 70 70 70 60 60 70 7 60 70 
    ;
    ECHO "After corners and bottom" ;
    ::: C01 := GEO: CAR2D 4 4
        EDIT 10
        CELL
        C1 C2 C3 C5
        C2 C4 C7 C6 
        C3 C7 C6 C6
        C5 C6 C6 C6
        MESHX 0.0 0.25 0.50 0.75 1.0
        MESHY 0.0 0.25 0.50 0.75 1.0
        ::: C1 := GEO: CARCEL 1
                RADIUS 0.0 0.05
                MIX 1 2
                MESHX 0.0 0.2
                MESHY 0.0 0.2
            ;
        ::: C2 := GEO: C1 MIX 1 2 ;
        ::: C3 := GEO: C1 MIX 1 2 ;
        ::: C4 := GEO: C1 MIX 1 2 ;
        ::: C5 := GEO: C1 MIX 1 2 ;
        ::: C6 := GEO: C1 MIX 1 2 ;
        ::: C7 := GEO: C1 MIX 1 2 ;
    ;
    ECHO "After C01" ;
    ::: C02 := GEO: CAR2D 3 4 
        CELL 
        C6 C5 C4
        C7 C6 C6 
        C6 C7 C6
        C6 C6 C7
        MESHX 0.0 0.3333 0.6666 1.0
        MESHY 0.0 0.25 0.5 0.75 1.0
        ::: C6 := GEO: CARCEL 1
            RADIUS 0.0 0.1
            MIX 1 2
            MESHX 0.0 0.3333
            MESHY 0.0 0.25
            ;
        ::: C4 := GEO: C6 ;
        ::: C5 := GEO: C6 ;
        ::: C7 := GEO: C6 ;
    ;
    ECHO "After C02" ;
    ::: C03 := GEO: CAR2D 3 4
        CELL
        C3 C2 C1
        C7 C4 C2
        C6 C7 C3
        C6 C5 C4
        MESHX 0.0 0.3333 0.6666 1.0
        MESHY 0.0 0.25 0.5 0.75 1.0
        ::: C1 := GEO: CARCEL 1
        RADIUS 0.0 0.1 
        MIX 1 2
        MESHX 0.0 0.3333
        MESHY 0.0 0.25
        ;
        ::: C2 := GEO: C1 MIX 1 2 ;
        ::: C3 := GEO: C1 MIX 1 2 ;
        ::: C4 := GEO: C1 MIX 1 2 ;
        ::: C5 := GEO: C1 MIX 1 2 ;
        ::: C6 := GEO: C1 MIX 1 2 ;
        ::: C7 := GEO: C1 MIX 1 2 ;
    ;
    ECHO "After C03" ;
    ::: C04 := GEO: CAR2D 3 3
        CELL
        C4 C6 C4
        C3 C7 C4
        C4 C4 C4
        MESHX 0.0 0.33 0.66 1.0
        MESHY 0.0 0.33 0.66 1.0
        ::: C3 := GEO: CARCEL 1
        RADIUS 0.0 0.1
        MIX 1 2
        MESHX 0.0 0.33333
        MESHY 0.0 0.33333
        ;
        ::: C4 := GEO: C3 MIX 1 2 ;
        ::: C6 := GEO: C3 MIX 1 2 ;
        ::: C7 := GEO: C3 MIX 1 2 ;
    ;
    ECHO "After C04" ;
    ::: C05 := GEO: CAR2D 3 3 
        CELL
        C4 C8 C3 
        C8 C4 C2
        C3 C2 C1 
        MESHX 0.0 0.33 0.66 1.0
        MESHY 0.0 0.33 0.66 1.0
        C1 := GEO: CARCEL 1
        RADIUS 0.0 0.1
        MIX 1 2
        MESHX 0.0 0.33333
        MESHY 0.0 0.33333
        ;
        ::: C2 := GEO: C1 MIX 1 2 ;
        ::: C3 := GEO: C1 MIX 1 2 ;
        ::: C4 := GEO: C1 MIX 1 2 ;
        ::: C8 := GEO: C1 MIX 1 2 ;
    ;
    ECHO "After C05" ;
    ::: CHNL := GEO: CAR2D 3 3
        MESHX 0.0 0.3333 0.6666 1.0
        MESHY 0.0 0.3333 0.6666 1.0
        MIX 70 70 70 70 70 70 70 70 70
    ;
    ::: WR1 := GEO: CAR2D 3 1
        MESHX 0.0 0.3333 0.6666 1.0
        MESHY 0.0 1.0
        MIX 7 60 70
    ;
    ::: WR2 := GEO: CAR2D 3 1
        MESHX 0.0 0.3333 0.6666 1.0
        MESHY 0.0 1.0
        MIX 7 60 70 
    ;
    ::: WR3 := GEO: CAR2D 3 1
        MESHX 0.0 0.3333 0.6666 1.0
        MESHY 0.0 1.0
        MIX 7 60 70 
    ; 



;